source:
  path: .
  use_gitignore: true

build:
  number: 0

outputs:
  - package:
      name: cpp_math
      version: 0.1.0
    build:
      script: |
        cmake $CMAKE_ARGS \
          -GNinja \
          -DCMAKE_BUILD_TYPE=Release \
          -DCMAKE_INSTALL_PREFIX=$PREFIX \
          -DCMAKE_EXPORT_COMPILE_COMMANDS=ON \
          -DBUILD_SHARED_LIBS=ON \
          -B $SRC_DIR/../build \
          -S .

        cmake --build $SRC_DIR/../build --target install
    requirements:
      build:
        - ${{ compiler('cxx') }}
        - cmake
        - ninja
      host:
        - python 3.12.*
        - nanobind
      run:
        - python 3.12.*

  - package:
      name: cpp_math-dev
      version: 0.1.0
    build:
      script: |
        # Create a placeholder dev package
        mkdir -p $PREFIX/share/cpp_math
        echo "Development package for cpp_math" > $PREFIX/share/cpp_math/README.txt
    requirements:
      run:
        - "${{ pin_subpackage('cpp_math', exact=True) }}"
