# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/main/schema.json
context:
  name: py-pixi-build-backend
  version: "${{ env.get('PY_PIXI_BUILD_BACKEND_VERSION', default='0.1.0dev') }}"

package:
  name: ${{ name }}
  version: ${{ version }}

source:
  path: ../../..

requirements:
  build:
    - if: build_platform != target_platform
      then:
        - python ${{ python_min }}.*
        - cross-python_${{ target_platform }} ${{ python_min }}.*
        - maturin >=1.2.2,<2
    - ${{ compiler('rust') }}
  host:
    - python ${{ python_min }}.*
    - python-abi3
    - maturin >=1.2.2,<2
    - pip

  run:
    - python >=${{ python_min }}
    - pixi-build-api-version >=4,<5
  ignore_run_exports:
    from_package:
      - cross-python_${{ target_platform }}

build:
  script:
    - cd pixi-build-backends/py-pixi-build-backend
    - pip install . -vv --no-build-isolation
  python:
    version_independent: true

tests:
  - python:
      python_version: ${{ python_min }}.*
      pip_check: false
      imports:
        - pixi_build_backend

about:
  homepage: https://github.com/prefix-dev/pixi-build-backends
  summary: Python bindings for pixi-build-backends
  description: |
    This package provides Python bindings for pixi-build-backends, enabling
    Python applications to use the pixi build system programmatically.
  license: BSD-3-Clause
  license_file: LICENSE
  documentation: https://prefix-dev.github.io/pixi-build-backends
  repository: https://github.com/prefix-dev/pixi-build-backends
