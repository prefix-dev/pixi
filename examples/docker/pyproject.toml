[build-system]
requires = ["flit_core>=3.2,<4"]
build-backend = "flit_core.buildapi"

[project]
name = "docker-project"
description = "A python project that gets installed in a docker container."
version = "0.1.0"
authors = [{ name = "prefix.dev", email = "noreply@prefix.dev" }]
classifiers = [
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.12",
]
requires-python = ">=3.12"

[tool.pixi.project]
name = "docker-project"
channels = ["conda-forge"]
platforms = ["linux-64", "linux-aarch64", "osx-arm64"]

[tool.pixi.dependencies]
flask = ">=3.0.2,<3.1"
gunicorn = ">=21.2.0,<21.3"

# Built editable in development mode
[tool.pixi.feature.dev.pypi-dependencies]
docker-project = { path = ".", editable = true }

# Built non-editable in production mode
[tool.pixi.feature.prod.pypi-dependencies]
docker-project = { path = ".", editable = false }

[tool.pixi.feature.test.dependencies]
pytest = "*"

[tool.pixi.tasks]
dev = "flask --app docker_project:app run"
start = "gunicorn -w 4 docker_project:app --bind :8000"

[tool.pixi.feature.test.tasks]
test = "pytest"

[tool.pixi.environments]
default = { features = ["test", "dev"] }
prod = { features = ["prod"] }
